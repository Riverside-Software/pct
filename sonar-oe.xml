<?xml version="1.0" encoding="utf-8"?>

<project name="PCT" default="sonar" xmlns:sonar="antlib:org.sonar.ant">

  <property name="sonar.host.url" value="${SONAR_URL}" />
  <property name="sonar.projectKey" value="eu.rssw.pct.oe:PCT" />
  <property name="sonar.projectName" value="PCT - OpenEdge module" />
  <property name="sonar.projectVersion" value="${BUILD_NUMBER}" />
  <property name="sonar.language" value="oe" />
  <property name="sonar.sources" value="src/progress" />
  <property name="sonar.exclusions" value="src/progress/pct/v8/**/*" />
  <property name="sonar.sourceEncoding" value="iso8859-1" />
  <property name="sonar.binaries" value="build/build-v11" />
  <property name="sonar.oe.cpd.newparser" value="true" />
  <property name="sonar.oe.propath" value="src/progress" />
  <property name="sonar.oe.databases" value="dictdb.df" />
  <property name="sonar.oe.dlc" value="${DLC}" />
  <property name="sonar.oe.dlc.propath" value="true" />
  <property name="sonar.verbose" value="false" />

  <!-- Specify sonar.branch property only when not on master -->
  <condition property="sonar.branch" value="${BRANCH_NAME}">
    <not><equals arg1="${git.branch}" arg2="master" /></not>    
  </condition>

  <path id="coverage.cp">
    <fileset dir="dist" includes="PCT.jar" />
    <fileset dir="lib" includes="guava.jar" />
    <fileset dir="lib" includes="antlr4-runtime-4.5.jar" />
  </path>

  <target name="sonar">
    <touch file="dictdb.df" />
    <taskdef uri="antlib:org.sonar.ant" resource="org/sonar/ant/antlib.xml">
      <classpath path="lib/sonarqube-ant-task-*.jar" />
    </taskdef>
    <sonar:sonar />
    <delete file="dictdb.df" />
  </target>

</project>
